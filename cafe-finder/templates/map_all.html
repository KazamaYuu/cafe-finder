{% extends 'layout.html' %}
{% block title %}Peta Semua Cafe - Cafe Finder{% endblock %}
{% block content %}
<div class="container mb-4">
  <h2 class="mb-3">Peta Semua Cafe</h2>
  <div id="map" style="width:100%;height:500px;border-radius:12px;box-shadow:0 2px 12px rgba(139,69,19,0.08);"></div>
  <div class="mt-3">
    <a href="{{ url_for('home') }}" class="btn btn-secondary">‚Üê Kembali</a>
  </div>
</div>
<script>
function initMap() {
  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 12,
    center: {lat: -7.2575, lng: 112.7521}, // Surabaya
    mapTypeId: 'roadmap'
  });
  var cafes = [
    {% for c in cafes %}
      {name: `{{ c.nama|escape }}`, lat: {{ c.latitude }}, lng: {{ c.longitude }}, id: `{{ c.id }}`},
    {% endfor %}
  ];
  cafes.forEach(function(cafe) {
    var marker = new google.maps.Marker({
      position: {lat: cafe.lat, lng: cafe.lng},
      map: map,
      title: cafe.name
    });
    var infowindow = new google.maps.InfoWindow({
      content: `<strong>${cafe.name}</strong><br><a href='{{ url_for('cafe_detail', cafe_id='') }}${cafe.id}'>Detail Cafe</a>`
    });
    marker.addListener('click', function() {
      infowindow.open(map, marker);
    });
  });
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&callback=initMap" async defer></script>
{% endblock %}
